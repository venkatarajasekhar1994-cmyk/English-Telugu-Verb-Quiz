<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="en"> <!-- Removed 'dark' class, theme is now handled by JS -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Learning Game Hub</title>
    
    <link rel="manifest" href="manifest.json">
    
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => console.log('Service Worker registered: ', registration))
                    .catch(error => console.error('Service Worker registration failed: ', error));
            });
        }
    </script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        /* FONT IMPORTS - Same as other game pages for consistency */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Lora:wght@700&family=Roboto:wght@400;700&family=Merriweather:wght@400;700&family=Playfair+Display:wght@700&family=Montserrat:wght@400;700;900&family=Source+Sans+3:wght@400;700&display=swap');
        
        /* THEME VARIABLES - Added Light & Dark modes */
        :root {
            --background-start-light: #f3f4f6;
            --background-end-light: #e5e7eb;
            --card-background-light: rgba(255, 255, 255, 0.7);
            --text-primary-light: #111827;
            --text-secondary-light: #4b5563;
            --shadow-light: rgba(0, 0, 0, 0.1);

            --background-start-dark: #111827;
            --background-end-dark: #1f2937;
            --card-background-dark: rgba(31, 41, 55, 0.7);
            --text-primary-dark: #f9fafb;
            --text-secondary-dark: #d1d5db;
            --shadow-dark: rgba(0, 0, 0, 0.3);
            
            /* Default Accent Colors */
            --primary-color: #6366f1;
            --secondary-color: #818cf8;
            --accent-color: #c4b5fd;
            
            /* Default to light mode variables */
            --bg-start: var(--background-start-light);
            --bg-end: var(--background-end-light);
            --card-bg: var(--card-background-light);
            --text-main: var(--text-primary-light);
            --text-sub: var(--text-secondary-light);
            --shadow-color: var(--shadow-light);

            /* Default fonts */
            --font-title: 'Montserrat', sans-serif;
            --font-body: 'Poppins', sans-serif;
        }

        .dark-mode {
            --bg-start: var(--background-start-dark);
            --bg-end: var(--background-end-dark);
            --card-bg: var(--card-background-dark);
            --text-main: var(--text-primary-dark);
            --text-sub: var(--text-secondary-dark);
            --shadow-color: var(--shadow-dark);
        }

        .font-title { font-family: var(--font-title); }
        .font-body { font-family: var(--font-body); }

        body {
            background: linear-gradient(135deg, var(--bg-start), var(--bg-end));
            color: var(--text-main);
            transition: background 0.5s ease, color 0.5s ease;
        }

        .game-card {
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .game-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 30px var(--shadow-color), 0 0 20px var(--accent-color);
        }
        .icon-circle {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }
        
        /* Modal Styles */
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background: linear-gradient(145deg, var(--bg-end), var(--bg-start));
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .setting-btn {
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: background-color 0.2s;
        }
        .setting-btn:hover {
             background-color: rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="font-body antialiased">

    <div class="min-h-screen w-full p-4 sm:p-6 lg:p-8 flex flex-col relative">
        <!-- Settings Button -->
        <div class="absolute top-4 right-4 z-20">
            <button onclick="openSettings()" class="w-12 h-12 rounded-full flex items-center justify-center text-xl transition-transform duration-300 hover:rotate-45" style="background: var(--card-bg); color: var(--text-sub);">
                <i class="fas fa-cog"></i>
            </button>
        </div>

        <!-- Header Section -->
        <header class="text-center mb-10 md:mb-16 pt-8">
            <h1 class="font-title font-black text-4xl sm:text-5xl md:text-6xl tracking-tighter">
                <span class="bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-purple-400" style="background-image: linear-gradient(to right, var(--primary-color), var(--secondary-color));">
                    English Learning Hub
                </span>
            </h1>
            <p id="header-subtitle" class="mt-4 text-lg max-w-2xl mx-auto" style="color: var(--text-sub);">
                Master grammar, expand your vocabulary, and conquer verbs with these interactive games.
            </p>
        </header>

        <!-- Games Grid -->
        <main class="flex-grow">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
                
                <a href="spoken_english.html" class="game-card rounded-2xl p-8 flex flex-col items-center text-center group">
                    <div class="icon-circle w-24 h-24 rounded-full flex items-center justify-center mb-6 shadow-lg">
                        <i class="fas fa-graduation-cap text-5xl text-white"></i>
                    </div>
                    <h2 class="font-title font-bold text-2xl mb-2" style="color: var(--text-main);">Spoken English Quiz</h2>
                    <p class="flex-grow" style="color: var(--text-sub);">
                        Test your knowledge with 45 lessons covering grammar from basic to advanced concepts.
                    </p>
                    <button class="mt-6 font-semibold bg-white/10 py-2 px-6 rounded-full border border-white/20 group-hover:text-white transition-colors duration-300" style="background-color: var(--primary-color);">
                        Start Learning
                    </button>
                </a>

                <a href="English vocabulary game.html" class="game-card rounded-2xl p-8 flex flex-col items-center text-center group">
                    <div class="icon-circle w-24 h-24 rounded-full flex items-center justify-center mb-6 shadow-lg">
                        <i class="fas fa-book-open text-5xl text-white"></i>
                    </div>
                    <h2 class="font-title font-bold text-2xl mb-2" style="color: var(--text-main);">Vocabulary Builder</h2>
                    <p class="flex-grow" style="color: var(--text-sub);">
                        Expand your word power with a challenging multiple-choice quiz.
                    </p>
                    <button class="mt-6 font-semibold bg-white/10 py-2 px-6 rounded-full border border-white/20 group-hover:text-white transition-colors duration-300" style="background-color: var(--primary-color);">
                        Build Vocabulary
                    </button>
                </a>

                <a href="Verbs game.html" class="game-card rounded-2xl p-8 flex flex-col items-center text-center group">
                    <div class="icon-circle w-24 h-24 rounded-full flex items-center justify-center mb-6 shadow-lg">
                        <i class="fas fa-running text-5xl text-white"></i>
                    </div>
                    <h2 class="font-title font-bold text-2xl mb-2" style="color: var(--text-main);">Irregular Verbs</h2>
                    <p class="flex-grow" style="color: var(--text-sub);">
                        Master the tricky past tense and participle forms of common English verbs.
                    </p>
                    <button class="mt-6 font-semibold bg-white/10 py-2 px-6 rounded-full border border-white/20 group-hover:text-white transition-colors duration-300" style="background-color: var(--primary-color);">
                        Master Verbs
                    </button>
                </a>
            </div>
        </main>
        
        <footer class="text-center py-6 mt-12" style="color: var(--text-sub);">
            <p>&copy; 2025 English Learning Hub. All rights reserved.</p>
        </footer>
    </div>
    
    <!-- Settings Modal -->
    <div id="settings-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop">
        <div class="modal-content w-full max-w-md rounded-2xl shadow-2xl p-6 relative">
            <button onclick="closeSettings()" class="absolute top-4 right-4 w-8 h-8 text-xl rounded-full transition-colors" style="color: var(--text-sub); background-color: rgba(255,255,255,0.1);">&times;</button>
            <h2 class="font-title text-2xl font-bold mb-6" style="color: var(--text-main);">Settings</h2>
            <div class="space-y-4">
                <!-- Theme Toggle -->
                <div class="flex items-center justify-between">
                    <span class="font-semibold" style="color: var(--text-sub);">Theme</span>
                    <button id="theme-toggle-btn" onclick="toggleTheme()" class="setting-btn px-4 py-2 rounded-lg text-sm font-semibold"></button>
                </div>
                <!-- Accent Color Selection -->
                <div class="flex items-center justify-between">
                    <span class="font-semibold" style="color: var(--text-sub);">Accent Color</span>
                    <button id="current-color-theme" onclick="openSelectionModal('color')" class="setting-btn px-4 py-2 rounded-lg text-sm font-semibold w-40 flex items-center justify-between truncate"></button>
                </div>
                <!-- Font Selection -->
                <div class="flex items-center justify-between">
                    <span class="font-semibold" style="color: var(--text-sub);">Title Font</span>
                    <button id="current-title-font" onclick="openSelectionModal('title')" class="setting-btn px-4 py-2 rounded-lg text-sm font-semibold w-40 text-left truncate"></button>
                </div>
                <div class="flex items-center justify-between">
                    <span class="font-semibold" style="color: var(--text-sub);">Body Font</span>
                    <button id="current-body-font" onclick="openSelectionModal('body')" class="setting-btn px-4 py-2 rounded-lg text-sm font-semibold w-40 text-left truncate"></button>
                </div>
            </div>
        </div>
    </div>

    <!-- Font & Color Selection Modal -->
    <div id="selection-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop">
        <div class="modal-content w-full max-w-md rounded-2xl shadow-2xl p-6 relative">
            <button onclick="closeSelectionModal()" class="absolute top-4 right-4 w-8 h-8 text-xl rounded-full" style="color: var(--text-sub); background-color: rgba(255,255,255,0.1);">&times;</button>
            <h2 id="selection-modal-title" class="font-title text-2xl font-bold mb-4" style="color: var(--text-main);">Select</h2>
            <div id="selection-list" class="max-h-60 overflow-y-auto space-y-2 pr-2"></div>
        </div>
    </div>
    
    <script>
        const FONT_OPTIONS = {
            title: [
                { value: `'Montserrat', sans-serif`, label: 'Montserrat' },
                { value: `'Lora', serif`, label: 'Lora' },
                { value: `'Playfair Display', serif`, label: 'Playfair Display' },
            ],
            body: [
                { value: `'Poppins', sans-serif`, label: 'Poppins' },
                { value: `'Inter', sans-serif`, label: 'Inter' },
                { value: `'Roboto', sans-serif`, label: 'Roboto' },
                { value: `'Source Sans 3', sans-serif`, label: 'Source Sans 3'},
                { value: `'Merriweather', serif`, label: 'Merriweather' },
            ]
        };
        const COLOR_THEMES = [
            { name: 'Indigo', primary: '#6366f1', secondary: '#818cf8', accent: '#c4b5fd' },
            { name: 'Teal', primary: '#14b8a6', secondary: '#2dd4bf', accent: '#5eead4' },
            { name: 'Rose', primary: '#f43f5e', secondary: '#fb7185', accent: '#fda4af' },
            { name: 'Amber', primary: '#f59e0b', secondary: '#fbbf24', accent: '#fcd34d' },
            { name: 'Sky', primary: '#38bdf8', secondary: '#7dd3fc', accent: '#bae6fd' }
        ];
        let currentSelectionType = null;

        // --- Local Storage Helpers ---
        function getLocalStorageSetting(key, defaultValue) {
            return localStorage.getItem(key) || defaultValue;
        }
        function setLocalStorageSetting(key, value) {
            localStorage.setItem(key, value);
        }

        // --- Theme Management ---
        function applyTheme(isDark) {
            const root = document.documentElement;
            const toggleBtn = document.getElementById('theme-toggle-btn');
            if (isDark) {
                root.classList.add('dark-mode');
                if (toggleBtn) toggleBtn.innerHTML = '<i class="fas fa-sun mr-2"></i> Light Mode';
            } else {
                root.classList.remove('dark-mode');
                if (toggleBtn) toggleBtn.innerHTML = '<i class="fas fa-moon mr-2"></i> Dark Mode';
            }
        }
        function toggleTheme() {
            const isDark = !document.documentElement.classList.contains('dark-mode');
            applyTheme(isDark);
            setLocalStorageSetting('theme', isDark ? 'dark' : 'light');
        }

        // --- Accent Color Management ---
        function applyAccentColor(themeName) {
            const theme = COLOR_THEMES.find(t => t.name === themeName) || COLOR_THEMES[0];
            const root = document.documentElement;
            root.style.setProperty('--primary-color', theme.primary);
            root.style.setProperty('--secondary-color', theme.secondary);
            root.style.setProperty('--accent-color', theme.accent);
            setLocalStorageSetting('colorTheme', themeName);
        }
        function updateColorButton() {
            const themeName = getLocalStorageSetting('colorTheme', COLOR_THEMES[0].name);
            const theme = COLOR_THEMES.find(t => t.name === themeName) || COLOR_THEMES[0];
            const btn = document.getElementById('current-color-theme');
            if (btn) {
                btn.innerHTML = `<span>${theme.name}</span> <span class="w-4 h-4 rounded-full border border-white/20" style="background-color: ${theme.primary};"></span>`;
            }
        }

        // --- Font Management ---
        function setBodyFont(fontFamily) {
            document.documentElement.style.setProperty('--font-body', fontFamily);
            setLocalStorageSetting('bodyFont', fontFamily);
        }
        function setTitleFont(fontFamily) {
            document.documentElement.style.setProperty('--font-title', fontFamily);
            setLocalStorageSetting('titleFont', fontFamily);
        }
        function getLabel(type, value) {
            const options = FONT_OPTIONS[type];
            const option = options.find(opt => opt.value === value);
            return option ? option.label : value;
        }
        function updateFontButton(type) {
            const id = type === 'body' ? 'current-body-font' : 'current-title-font';
            const storageKey = type === 'body' ? 'bodyFont' : 'titleFont';
            const defaultFont = type === 'body' ? FONT_OPTIONS.body[0].value : FONT_OPTIONS.title[0].value;
            const value = getLocalStorageSetting(storageKey, defaultFont);
            document.getElementById(id).textContent = getLabel(type, value);
        }

        // --- Modal Management ---
        window.openSettings = function() {
            document.getElementById('settings-modal').classList.remove('hidden');
            updateSettingsUI();
        }
        window.closeSettings = function() {
            document.getElementById('settings-modal').classList.add('hidden');
        }
        function updateSettingsUI() {
            const isDark = document.documentElement.classList.contains('dark-mode');
            applyTheme(isDark); // Updates the button text
            updateFontButton('title');
            updateFontButton('body');
            updateColorButton();
        }

        window.openSelectionModal = function(type) {
            currentSelectionType = type;
            const modal = document.getElementById('selection-modal');
            const listEl = document.getElementById('selection-list');
            let optionsHTML = '';

            if (type === 'color') {
                document.getElementById('selection-modal-title').textContent = 'Select Accent Color';
                optionsHTML = COLOR_THEMES.map(opt => `
                    <button onclick="handleSelectionChange('${type}', '${opt.name}')" class="w-full text-left p-2 rounded-md setting-btn flex items-center justify-between">
                        <span style="color: var(--text-sub);">${opt.name}</span>
                        <span class="w-5 h-5 rounded-full border border-white/20" style="background-color: ${opt.primary};"></span>
                    </button>
                `).join('');
            } else { // 'title' or 'body'
                document.getElementById('selection-modal-title').textContent = `Select ${type === 'title' ? 'Title' : 'Body'} Font`;
                const options = FONT_OPTIONS[type];
                optionsHTML = options.map(opt => 
                    `<button onclick="handleSelectionChange('${type}', '${opt.value}')" class="w-full text-left p-2 rounded-md setting-btn" style="font-family: ${opt.value}; color: var(--text-sub);">${opt.label}</button>`
                ).join('');
            }
            
            listEl.innerHTML = optionsHTML;
            modal.classList.remove('hidden');
        }
        window.closeSelectionModal = function() {
            document.getElementById('selection-modal').classList.add('hidden');
            currentSelectionType = null;
        }
        window.handleSelectionChange = function(type, value) {
            if (type === 'body') {
                setBodyFont(value);
                updateFontButton(type);
            } else if (type === 'title') {
                setTitleFont(value);
                updateFontButton(type);
            } else if (type === 'color') {
                applyAccentColor(value);
                updateColorButton();
            }
            closeSelectionModal();
        }
        
        // --- Initialization ---
        function loadInitialSettings() {
            const currentMode = getLocalStorageSetting('theme', (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'));
            applyTheme(currentMode === 'dark');

            const titleFont = getLocalStorageSetting('titleFont', FONT_OPTIONS.title[0].value);
            const bodyFont = getLocalStorageSetting('bodyFont', FONT_OPTIONS.body[0].value);
            setTitleFont(titleFont);
            setBodyFont(bodyFont);
            
            const colorTheme = getLocalStorageSetting('colorTheme', COLOR_THEMES[0].name);
            applyAccentColor(colorTheme);
        }
        
        window.onload = loadInitialSettings;
    </script>
</body>
</html>


